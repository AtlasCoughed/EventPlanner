<!doctype html>
<html itemscope itemtype="http://schema.org/Article">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <!-- Place favicon.ico in the root directory -->

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <script src="js/vendor/modernizr-2.8.3.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script src="https://apis.google.com/js/client:platform.js?onload=start" async defer></script>
        <script>
            function start() {
                gapi.load('auth2', function() {
                    auth2 = gapi.auth2.init({
                        client_id: '362371810719-5n2mdq5ham1de9iqpfljdo39fq1pb48t.apps.googleusercontent.com',
                        // Scopes to request in addition to 'profile' and 'email'
                        scope: 'https://www.googleapis.com/auth/plus.me'
                    });
                });
            }
        </script>
    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
        <p>Hello world! This is HTML5 Boilerplate.</p>
        <button id="signinButton">Sign in with Google</button>
        <script>
            $('#signinButton').click(function() {
                auth2.grantOfflineAccess({'redirect_uri': 'postmessage'}).then(signInCallback);
            });
        </script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>

        <script>
            function signInCallback(authResult) {
                if (authResult['code']) {
                    $('#signinButton').attr('style', 'display: none');
                    $.ajax({
                        type: 'POST',
                        url: 'http://example.com/storeauthcode',
                        contentType: 'application/octet-stream; charset=utf-8',
                        success: function(result) {
                            console.log("RESULT:", result);
                        },
                        processData: false,
                        data: authResult['code']
                    });
                } else {
                    console.log("SignInCallback, ERROR")
                }
            }
        </script>

    </body>
</html>
